<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>缤纷礼盒</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        *{
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }
        body{
            background: url("../images/gift/gift_bg.jpg") no-repeat;
            width: 1920px;
            height: 1080px;
            overflow: hidden;
            font-family: Microsoft YaHei;
        }
        .area,
        .item,
        .pic,
        .txt,
        .item_bg,
        .original,
        .present,
        .select{
            position: absolute;
        }

        .area_0{
            width:1082px;
            height:65px;
            padding:13px 0 0 0;
            line-height:52px;
            background: url("../images/gift/tab_bg.png");
        }
        .area_0 .item{
            font-size:30px;
            padding:0 30px;
        }
        .area_0 .item_focus{
            color: #F4EA2A;
            background: url("../images/gift/icon_arrow.png") no-repeat 2px center;
        }
        .area_0 .item_active{
            color: #F4EA2A;
        }

        .area_1 .item .item_bg{
            width:257px;
            height:335px;
            background: url("../images/gift/item_bg.png");
        }
        .area_1 .item .pic{
            width:257px;
            height:212px;
        }
        .area_1 .item .pic img{
            position: absolute;
            left:0;right:0;
            top:0;bottom:0;
            margin:auto;
        }
        .area_1 .item .original{
            color:#9C9C9C;
            text-decoration: line-through;
            font-size:16px;
            width:257px;
            padding:0 22px 0 0;
            text-align: right;
            line-height:24px;
            top:192px;
        }
        .area_1 .item .present{
            color: #7C5BC4;
            font-size:30px;
            width:257px;
            padding:0 22px 0 0;
            text-align: right;
            line-height:30px;
            top:220px;
        }
        .area_1 .item .txt{
            width: 257px;
            height:74px;
            text-align: center;
            line-height:74px;
            font-size:28px;
            top:257px;
        }
        .area_1 .item .free{
            width:65px;
            height:69px;
            background: url("../images/gift/icon_free.png");
            position: absolute;
            left:-25px;
            top:-29px;
            z-index:20;
        }
        .area_1 .select img{
            width:257px;
            height:335px;
        }

        .area_2 .select{
            left:-2px;
            top:-5px;
        }

        .dark_bg{
            position: relative;
            width:1920px;
            height:1080px;
            background: url("../images/gift/dark_bg.png");
            z-index:20;
            display: none;
        }
        .code_bg{
            width:493px;
            height:441px;
            position: absolute;
            left:0;
            right:0;
            top:0;
            bottom:0;
            margin:auto;
            background: url("../images/gift/erweima_bg.png");
        }
        #code{
            width:162px;
            height:162px;
            position: absolute;
            left:235px;
            top:171px;
        }
    </style>
</head>
<body bgcolor="transparent">
<div id="body_area">
    <div class="pic" style="left: 558px;"><img src="../images/gift/top.png" alt=""></div>
    <div class="area area_0" style="left: 414px;top: 316px;">
        <div class="item" id="area0_item_0" style="left: 90px;">新品</div>
        <div class="item" id="area0_item_1" style="left: 220px;">热卖</div>
        <div class="item" id="area0_item_2" style="left: 356px;">超级飞侠专区</div>
        <div class="item" id="area0_item_3" style="left: 606px;">悠悠球专区</div>
        <div class="item" id="area0_item_4" style="left: 830px;">教育课程</div>
    </div>
    <div class="area area_1" style="left: 128px;top: 446px;">
        <div class="item" id="area1_item_0">
            <div class="item_bg"></div>
            <div class="pic"><img id="area1_pic_0" src="" alt=""></div>
            <div class="original"></div>
            <div class="present"></div>
            <div class="txt" id="area1_txt_0"></div>
            <div class="free"></div>
            <div class="select"><img src="../images/gift/item_select.png" alt=""></div>
        </div>
        <div class="item" id="area1_item_1" style="left: 347px;">
            <div class="item_bg"></div>
            <div class="pic"><img id="area1_pic_1" src="" alt=""></div>
            <div class="original"></div>
            <div class="present"></div>
            <div class="txt" id="area1_txt_1"></div>
            <div class="free"></div>
            <div class="select"><img src="../images/gift/item_select.png" alt=""></div>
        </div>
        <div class="item" id="area1_item_2" style="left: 696px;">
            <div class="item_bg"></div>
            <div class="pic"><img id="area1_pic_2" src="" alt=""></div>
            <div class="original"></div>
            <div class="present"></div>
            <div class="txt" id="area1_txt_2"></div>
            <div class="free"></div>
            <div class="select"><img src="../images/gift/item_select.png" alt=""></div>
        </div>
        <div class="item" id="area1_item_3" style="left: 1051px;">
            <div class="item_bg"></div>
            <div class="pic"><img id="area1_pic_3" src="" alt=""></div>
            <div class="original"></div>
            <div class="present"></div>
            <div class="txt" id="area1_txt_3"></div>
            <div class="free"></div>
            <div class="select"><img src="../images/gift/item_select.png" alt=""></div>
        </div>
        <div class="item" id="area1_item_4" style="left: 1407px;">
            <div class="item_bg"></div>
            <div class="pic"><img id="area1_pic_4" src="" alt=""></div>
            <div class="original"></div>
            <div class="present"></div>
            <div class="txt" id="area1_txt_4"></div>
            <div class="free"></div>
            <div class="select"><img src="../images/gift/item_select.png" alt=""></div>
        </div>
    </div>
    <div class="area area_2">
        <div class="item" id="area2_item_0" style="left: 191px;top: 792px;">
            <div class="pic"><img src="../images/gift/btn_buy.png" alt=""></div>
            <div class="select"><img src="../images/gift/btn_buy_s.png" alt=""></div>
        </div>
        <div class="item" id="area2_item_1" style="left: 538px;top: 792px;">
            <div class="pic"><img src="../images/gift/btn_buy.png" alt=""></div>
            <div class="select"><img src="../images/gift/btn_buy_s.png" alt=""></div>
        </div>
        <div class="item" id="area2_item_2" style="left: 887px;top: 792px;">
            <div class="pic"><img src="../images/gift/btn_buy.png" alt=""></div>
            <div class="select"><img src="../images/gift/btn_buy_s.png" alt=""></div>
        </div>
        <div class="item" id="area2_item_3" style="left: 1242px;top: 792px;">
            <div class="pic"><img src="../images/gift/btn_buy.png" alt=""></div>
            <div class="select"><img src="../images/gift/btn_buy_s.png" alt=""></div>
        </div>
        <div class="item" id="area2_item_4" style="left: 1598px;top: 792px;">
            <div class="pic"><img src="../images/gift/btn_buy.png" alt=""></div>
            <div class="select"><img src="../images/gift/btn_buy_s.png" alt=""></div>
        </div>
    </div>
    <!--弹出框：二维码-->
    <div class="dark_bg">
        <div class="code_bg">
            <img id="code" src="../images/gift/erweima.jpg" alt="">
        </div>
    </div>
</div>
<script type="text/javascript" src="../js/WkEpg3.0.js"></script>
<script type="text/javascript" src="../js/jquery-1.8.3.min.js"></script>
<script>
    var pageobj;
    (function(window, document) {
        var area0, area1, area2;
        var url = window.location.href;
        var indexid = !WkEpg.Util.getURLParameter("indexid", url) ? 0 : parseInt(WkEpg.Util.getURLParameter("indexid", url)); //焦点数据
        var areaid = !WkEpg.Util.getURLParameter("areaid", url) ? 2 : parseInt(WkEpg.Util.getURLParameter("areaid", url));    //焦点数据
        var realindex = !WkEpg.Util.getURLParameter("realindex", url) ? 0 : parseInt(WkEpg.Util.getURLParameter("realindex", url));
        var returnurl = !WkEpg.Util.getURLParameter("returnurl", url) ? "index.html" : decodeURIComponent(WkEpg.Util.getURLParameter("returnurl", url));

        var focusObj = null;
        var dataObj = null;
        var controlObj = null;
        var itemSize = 5;
        var nameCut = 8;
        var darkOpenFlag = false;

        var testData = {
            resultSet: [
                {
                    type: 0,
                    data: [
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                    ]
                },
                {
                    type: 1,
                    data: [
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                    ]
                },
                {
                    type: 2,
                    data: [
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                    ]
                },
                {
                    type: 3,
                    data: [
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                    ]
                },
                {
                    type: 4,
                    data: [
                        {title: '木质数学棒', present:'29.00', original: '48.00', fileurl: '../images/gift/img4.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '多多变形蛋', present:'68.00', original: '88.00', fileurl: '../images/gift/img1.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                        {title: '跳跃战士', present:'88.00', original: '128.00', fileurl: '../images/gift/img3.png'},
                        {title: '美吉姆艺术课程', present:'568.00', original: '926.00', fileurl: '../images/gift/img0.png'},
                        {title: '火力悠悠球 冰焰', present:'88.00', original: '128.00', fileurl: '../images/gift/img2.png'},
                    ]
                }
            ]
        }

        //焦点移动类
        function FocusMove() {
            this.createArea();
            this.createFunction();
            this.marqueeName();
        }
        FocusMove.prototype = {
            createArea: function(){
                //@ Array(上、左、下、右)
                //@ area.stablemoveindex("fromIndex-toId>toIndex")
                area0 = WkEpg.AreaCreator(1, 5, [-1, -1, 2, -1], "area0_item_", "className:item item_focus", "className:item");
                area1 = WkEpg.AreaCreator(1, 5, [0, -1, 2, -1], "area1_item_", "className:item item_focus", "className:item");
                area2 = WkEpg.AreaCreator(1, 5, [0, -1, -1, -1], "area2_item_", "className:item item_focus", "className:item");

                area1.stablemoveindex = ["0-0>0", -1, "0-2>0,1-2>1,2-2>2,3-2>3,4-2>4" ,-1];
//                area2.stablemoveindex = ["0-1>0,1-1>1,2-1>2,3-1>3,4-1>4", -1, -1, -1];

                pageobj = WkEpg.PageCreator(areaid, indexid, new Array(area0, area1, area2));

                area0.setDarkfocus(area0.curpage, area0.curindex, new Array("className:item item_focus"), new Array("className:item item_active"));//设置暗焦点

                area1.setbroadwiseCrossturnpage(true);//设置纵向自动翻页
                area1.curpage = 1;
            },
            createFunction: function () {
                area0.areaOkEvent = function(){
                    area1.curpage = 1;
                    dataObj.loadItems(this.curindex);
                }
                area1.areaPageTurnEvent = function (num) {
                    if (this.pagecount <= 1) {
                        return;
                    }
                    this.lock = true;
                    dataObj.loadItems(area0.curindex);
                };
                area2.areaOkEvent = function(){
                    $('.dark_bg').show();
                    darkOpenFlag = true;
                }

                WkEpg.Nav.keyBackEvent = function() {
                    if(darkOpenFlag){
                        $('.dark_bg').hide();
                        darkOpenFlag = false;
                    }
                    else{
                        WkEpg.Util.gotoPage(returnurl);
                    }
                };
            },
            marqueeName: function () {
                area1.changefocusAfterEvent = function() {
                    if (this.doms[this.curindex] != undefined && WkEpg.Util.getStrRealLen(this.doms[this.curindex].contentName) > nameCut * 2)
                        $("#area1_txt_" + this.curindex).html("<marquee direction='left' scrolldelay='200'>" + this.doms[this.curindex].contentName + "</marquee>");
                };
                area1.changeunfocusBeforeEvent = function() {
                    if (this.doms[this.curindex] != undefined && WkEpg.Util.getStrRealLen(this.doms[this.curindex].contentName) > nameCut * 2)
                        $("#area1_txt_" + this.curindex).html(WkEpg.Util.getSubStr(this.doms[this.curindex].contentName, nameCut * 2, true));
                };
                if (pageobj.curareaid == 1)
                    pageobj.areas[pageobj.curareaid].changefocusAfterEvent();
            }
        };

        //Dom操作类 页面滑动 轮播
        function DomControl() {
        }
        DomControl.prototype = {
            renderItems: function(items){
                for(var i = 0;i < itemSize; i++){
                    if(i < area1.datanum){
                        area1.doms[i].contentName = items[i]['name'];
                        $('#area1_pic_' + i).attr("src", items[i].fileurl);
                        $('#area1_txt_' + i).html(WkEpg.Util.getSubStr(items[i]['title'], nameCut * 2, true));
                        $('.original')[i].innerHTML = '原价:￥' + items[i].original;
                        $('.present')[i].innerHTML = '￥' + items[i].present;
                        $('#area1_item_' + i).show();
                        $('#area2_item_' + i).show();
                    } else {
                        $('#area1_item_' + i).hide();
                        $('#area2_item_' + i).hide();
                    }
                }
                area1.lock = false;
            }
        };

        //加载数据的类
        function loadData() {
            this.itemSize = 5;
            this.loadItems(0);
            this.getReturnUrl();
        }
        loadData.prototype = {
            loadItems: function(categoryId){
                programs = testData.resultSet[categoryId].data.slice((area1.curpage - 1) * this.itemSize, (area1.curpage - 1) * this.itemSize + this.itemSize);
                area1.datanum = programs.length;
                area2.datanum = programs.length;
                area1.pagecount = Math.ceil(testData.resultSet[categoryId].data.length / this.itemSize);
                controlObj.renderItems(programs);
            },
            getReturnUrl : function(areaid, indexid) {
                // realindex = (area1.curpage - 1) * pageSize + indexid;
                if (url.indexOf('?') > 0) {
                    return url.split('?')[0] + "?realindex=" + realindex + "&areaid=" + areaid + "&indexid=" + indexid + "&returnurl=" + encodeURIComponent(returnurl);
                } else {
                    return url + "?realindex=" + realindex + "&areaid=" + areaid + "&indexid=" + indexid + "&returnurl=" + encodeURIComponent(returnurl);
                }
            }
        };

        //初始化
        window.addEventListener("unload", function() {
        }, false);
        window.addEventListener("load", function() {
            window.focus();
            if (!focusObj) focusObj = new FocusMove();
            if (!controlObj) controlObj = new DomControl();
            if (!dataObj) dataObj = new loadData();
        }, false);
    })(window, document);
</script>
</body>
</html>